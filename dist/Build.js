!function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);class i{constructor(){this.setEventsListeners()}setEventsListeners(){}}class a{constructor(){this.localStorage=window.localStorage}writeDataByKey(e,t){this.localStorage.setItem(e,JSON.stringify(t))}getDataByKey(e){return JSON.parse(this.localStorage.getItem(e))}}class r extends i{constructor(){super(),this.storageManager=new a,this.init()}setEventsListeners(){document.querySelector("#submitUserInfo").addEventListener("click",this.handleSubmit.bind(this))}init(){this.users=this.storageManager.getDataByKey("users")||[]}handleSubmit(e){e.preventDefault();const t=document.querySelector(".authorization"),s=document.querySelector(".dark-bg"),i=document.querySelectorAll(".auth-input");this.checkFillInInputs.call(this,i)&&(this.checkUniqueUser.call(this,i)?this.users.some(e=>e.email===i[2].value&&(this.currentUser=e,!0)):(this.currentUser={firstName:i[0].value,lastName:i[1].value,email:i[2].value,results:{easy:0,medium:0,hard:0}},this.users.push(this.currentUser)),t.classList.add("hide-win"),s.classList.add("hide-win"))}checkUniqueUser(e){return this.users.some(t=>t.email===e[2].value)}checkFillInInputs(e){return Array.prototype.every.call(e,e=>e.value)}getTopResultsTable(e,t){const s=document.createDocumentFragment(),i=document.createElement("table");i.classList.add("rez-table");const a=document.createElement("tr"),r=document.createElement("th"),n=document.createElement("th"),c=document.createElement("th");return c.innerText="User",r.innerText="User's email",n.innerText=e,a.appendChild(c),a.appendChild(r),a.appendChild(n),i.appendChild(a),this.users.forEach(s=>{s.email===this.currentUser.email&&(s.results[e]=t)}),console.log(this.users),this.writeUpdatedDataToStorage(),this.getResultsForOutput(e).forEach(e=>{const t=document.createElement("tr"),s=document.createElement("td"),a=document.createElement("td"),r=document.createElement("td");r.innerText=e.fullName,s.innerText=e.email,e.rez?a.innerText=e.rez.minutes+" min "+e.rez.seconds+" sec":a.innerText=0,t.appendChild(r),t.appendChild(s),t.appendChild(a),i.appendChild(t)}),s.appendChild(i)}getResultsForOutput(e){const t=[];this.users.forEach(s=>{t.push({email:s.email,fullName:s.firstName+" "+s.lastName,rez:s.results[e]})});const s=t.length;let i;for(let e=0;e<s-1;e++)for(let a=e+1;a<s;a++)t[e].rez.valueOf()<t[a].rez.valueOf()&&(console.log("    "+t[e].rez.valueOf()+"    "+t[a].rez.valueOf()),i=t[e],t[e]=t[a],t[a]=i);return s>10&&t.slice(0,10),t}writeUpdatedDataToStorage(){this.storageManager.writeDataByKey("users",this.users)}}const n=[{id:"shirt1"},{id:"shirt2"},{id:"shirt3"}],c=[{value:"10",id:"easy"},{value:"18",id:"medium"},{value:"24",id:"hard"}],d=[{id:"first-back"},{id:"second-back"},{id:"third-back"},{id:"fours-back"},{id:"fives-back"},{id:"sixes-back"},{id:"sevens-back"},{id:"eights-back"},{id:"nines-back"},{id:"tens-back"},{id:"elevens-back"},{id:"twelves-back"}];class l extends i{constructor(){super(),this.value=d.slice(0,c[0].value/2)}setInstance(e){this.value=d.slice(0,e/2),this.value=this.value.concat(this.value),this.setRandomBacks()}setRandomBacks(){for(let e=this.value.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1)),s=this.value[e];this.value[e]=this.value[t],this.value[t]=s}}}class o extends i{constructor(){super(),this.stringValue=c[0].id,this.value=c[0].value,this.cardSize=c[0].id}setEventsListeners(){const e=document.querySelector("#easy"),t=document.querySelector("#medium"),s=document.querySelector("#hard");e.addEventListener("click",i=>{this.cardSize=c[0].id,this.value=c[0].value,this.stringValue=c[0].id,e.classList.add("active"),t.classList.remove("active"),s.classList.remove("active")}),t.addEventListener("click",i=>{this.cardSize=c[1].id,this.value=c[1].value,this.stringValue=c[1].id,t.classList.add("active"),e.classList.remove("active"),s.classList.remove("active")}),s.addEventListener("click",i=>{this.cardSize=c[2].id,this.value=c[2].value,this.stringValue=c[2].id,s.classList.add("active"),e.classList.remove("active"),t.classList.remove("active")})}}class u extends i{constructor(){super(),this.value=n[0].id}setEventsListeners(){const e=document.querySelector("#shirt1"),t=document.querySelector("#shirt2"),s=document.querySelector("#shirt3");e.addEventListener("click",i=>{this.value=n[0].id,e.classList.add("active"),t.classList.remove("active"),s.classList.remove("active")}),t.addEventListener("click",i=>{this.value=n[1].id,t.classList.add("active"),e.classList.remove("active"),s.classList.remove("active")}),s.addEventListener("click",i=>{this.value=n[2].id,s.classList.add("active"),e.classList.remove("active"),t.classList.remove("active")})}}class h{constructor(){this.cardsManager=new l,this.difficult=new o,this.shirt=new u}painting(e){this.cardsManager.setInstance(this.difficult.value),this.cardsManager.value.forEach(t=>{const s=document.createElement("div");s.className="item",s.classList.add(this.difficult.cardSize),e.appendChild(s);const i=document.createElement("div");i.classList.add("theCard"),i.setAttribute("id",t.id),s.appendChild(i);const a=document.createElement("div");a.classList.add("theFront"),a.classList.add(this.shirt.value),i.appendChild(a);const r=document.createElement("div");r.classList.add("theBack"),r.classList.add(t.id),i.appendChild(r)})}}class m{constructor(e,t){this.gameField=document.querySelector(".window-game"),this.seconds=document.querySelector("#seconds"),this.minutes=document.querySelector("#minutes"),this.options=e,this.userManager=t,this.inMatch=!1,this.prevCard=null,this.hiddenCardsCount=0,this.startNewGame()}startNewGame(){this.clearGameField(),this.setTimer(),this.options.painting(this.gameField),document.querySelectorAll(".theCard").forEach(e=>{e.addEventListener("click",this.checkClick.bind(this,{id:e.getAttribute("id"),cardPageElement:e}))})}setTimer(){this.timerActive=!0,this.seconds.innerText=0,this.minutes.innerText=0,setTimeout(function e(){this.timerActive&&(59==+this.seconds.innerText?(this.seconds.innerText=0,this.minutes.innerText++):this.seconds.innerText++,setTimeout(e.bind(this),1e3))}.bind(this),1e3)}stopTimer(){this.timerActive=!1}clearGameField(){for(;this.gameField.firstChild;)this.gameField.removeChild(this.gameField.firstChild)}checkClick(e){this.inMatch||(e.cardPageElement.classList.add("theCard-rotate"),this.prevCard?(this.inMatch=!0,setTimeout(()=>this.matchCards(e),1e3)):this.prevCard=e)}matchCards(e){this.inMatch=!1,e.cardPageElement!==this.prevCard.cardPageElement&&(e.cardPageElement.classList.remove("theCard-rotate"),this.prevCard.cardPageElement.classList.remove("theCard-rotate"),e.id===this.prevCard.id&&(e.cardPageElement.removeEventListener("click",this.checkClick),this.prevCard.cardPageElement.removeEventListener("click",this.checkClick),e.cardPageElement.classList.add("theCard-hidden"),this.prevCard.cardPageElement.classList.add("theCard-hidden"),this.hiddenCardsCount+=2,this.hiddenCardsCount===+this.options.difficult.value&&this.finishGame()),this.prevCard=null)}finishGame(){this.clearGameField(),this.stopTimer();const e=document.createElement("article"),t=document.createElement("span"),s=document.createElement("span"),i=document.createElement("br"),a={minutes:this.minutes.innerText,seconds:this.seconds.innerText,valueOf:()=>60*a.minutes+a.seconds};console.log(a.valueOf()),e.classList.add("conclusion"),t.classList.add("conclusion"),t.innerText="Victory. Our celebrations!",s.classList.add("conclusion"),s.innerText="Your time: "+a.minutes+" minutes "+a.seconds+" seconds!",e.appendChild(t),e.appendChild(i),e.appendChild(s),e.appendChild(this.userManager.getTopResultsTable(this.options.difficult.stringValue,a)),this.gameField.appendChild(e)}}new class{constructor(){this.currentGame=null,this.start()}start(){const e=document.querySelector("#newGame"),t=new h,s=new r;e.addEventListener("click",e=>{this.currentGame&&this.currentGame.stopTimer(),this.currentGame=new m(t,s)})}}}]);